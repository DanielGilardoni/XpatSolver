(* Exemple de génération de permutation pour la graine 1, étape par étape *)

(* a) les 55 paires *)

let paires =
[(0, 1); (21, 1); (42, 0); (8, 1); (29, 999999999); (50, 2); (16, 999999997);
 (37, 5); (3, 999999992); (24, 13); (45, 999999979); (11, 34); (32, 999999945);
 (53, 89); (19, 999999856); (40, 233); (6, 999999623); (27, 610);
 (48, 999999013); (14, 1597); (35, 999997416); (1, 4181); (22, 999993235);
 (43, 10946); (9, 999982289); (30, 28657); (51, 999953632); (17, 75025);
 (38, 999878607); (4, 196418); (25, 999682189); (46, 514229); (12, 999167960);
 (33, 1346269); (54, 997821691); (20, 3524578); (41, 994297113); (7, 9227465);
 (28, 985069648); (49, 24157817); (15, 960911831); (36, 63245986);
 (2, 897665845); (23, 165580141); (44, 732085704); (10, 433494437);
 (31, 298591267); (52, 134903170); (18, 163688097); (39, 971215073);
 (5, 192473024); (26, 778742049); (47, 413730975); (13, 365011074);
 (34, 48719901)]

(* b) les FIFO initiales.
   On les affiche ici comme des listes, avec la sortie de la FIFO à la gauche
   de la liste.
*)

let f1_init =
[997821691; 89; 134903170; 999953632; 2; 24157817; 999999013; 413730975;
   514229; 999999979; 732085704; 10946; 0; 994297113; 233; 971215073;
   999878607; 5; 63245986; 999997416; 48719901; 1346269; 999999945; 298591267;
   28657; 999999999; 985069648; 610; 778742049; 999682189; 13]

let f2_init =
[165580141; 999993235; 1; 3524578; 999999856; 163688097; 75025; 999999997;
   960911831; 1597; 365011074; 999167960; 34; 433494437; 999982289; 1; 9227465;
   999999623; 192473024; 196418; 999999992; 897665845; 4181; 1]

(* d) les 165 tirages d'initialisation
   Les 165 valeurs tirées (et ignorées) sont dans cet ordre: *)

let ignored_165 =
[ 832241550; 6854; 134903169; 996429054; 146; 860469720; 999923988; 413730978;
  39602398; 999998382; 367074630; 842986; 999999966; 560802676; 17944;
  971215072; 990651142; 382; 870772962; 999800998; 48719909; 103680424;
  999995764; 298591266; 167787107; 999993145; 850166479; 3571556; 778741903;
  139212469; 76025; 751849163; 960390837; 1619; 636449948; 999156870; 163688131;
  439272349; 999982053; 989696759; 9350455; 365010692; 128394998; 199036;
  384774528; 896301865; 4237; 710636199; 832212516; 192479879; 150029939;
  996428436; 118923942; 860791712; 999923976; 80392387; 39616017; 134901550;
  359979106; 843276; 696781589; 560651639; 413748925; 49905639; 990647927;
  2063938; 872447988; 999800930; 176028148; 103716079; 971210835; 280014943;
  167787866; 678293083; 849771059; 52291473; 984756482; 139204052; 298667290;
  87394720; 960377128; 715264929; 643592450; 777898627; 442430880; 439424386;
  338100238; 910485198; 9353692; 634386010; 126708882; 163887201; 263244201;
  896265974; 18485924; 729335512; 197222826; 450101915; 150427977; 332483055;
  911545383; 860800185; 411968909; 744817796; 232102751; 434765010; 352835986;
  341025315; 418360832; 560499590; 742292149; 129130819; 125547858; 725593096;
  874134394; 532894388; 297407438; 517482951; 31419715; 261312415; 804841112;
  422346073; 849372953; 843545093; 192170696; 110410650; 868046034; 422970070;
  446190332; 415006049; 699455487; 643731167; 720843220; 738167700; 345102571;
  831246309; 589717071; 917999354; 903764233; 909536492; 142016948; 820617287;
  879065483; 748041277; 829544898; 704362809; 314514248; 419699108; 704095278;
  908075274; 861289478; 774252756; 3911583; 735421928; 633027568; 267814216;
  139956965; 673801209; 399715225; 400856442; 845047939; 434836632; 437261082;
  508824340; 418482642 ]

(* Et après ces tirages, l'état des deux FIFO est alors (toujours avec les FIFO
   affichées avec leur sortie à gauche) : *)

let f1_165 =
[ 742292149; 129130819; 125547858; 725593096; 874134394; 532894388;
    297407438; 517482951; 31419715; 261312415; 804841112; 422346073; 849372953;
    843545093; 192170696; 110410650; 868046034; 422970070; 446190332;
    415006049; 699455487; 643731167; 720843220; 738167700; 345102571;
    831246309; 589717071; 917999354; 903764233; 909536492; 142016948]

let f2_165 =
[ 820617287; 879065483; 748041277; 829544898; 704362809; 314514248;
    419699108; 704095278; 908075274; 861289478; 774252756; 3911583; 735421928;
    633027568; 267814216; 139956965; 673801209; 399715225; 400856442;
    845047939; 434836632; 437261082; 508824340; 418482642]

(* e) Les 52 tirages suivants (en nombres bruts dans [0..randmax[) : *)

let tirages_52 =
[ 921674862; 250065336; 377506581; 896048198; 169771585; 218380140; 877708330;
  813387673; 123344441; 400022937; 30588356; 418434490; 113951025; 210517525;
  924356480; 970453685; 194244825; 23254845; 45333890; 569958110; 264618855;
  206470085; 212018880; 319685058; 423427709; 581180973; 212210490; 21951156;
  733992648; 691156352; 264308618; 7229614; 755721042; 348018340; 798956542;
  285928319; 200563223; 209181583; 779738798; 937621589; 667044653; 750997911;
  958577693; 165463818; 368408713; 61344131; 927938085; 354116151; 976287516;
  819675469; 632837449; 412885476 ]

(* Ces 52 tirages "réduits", le premier dans [0..52[, le second dans [0..51[,
   jusqu'au dernier dans [0..1[ *)

let reduced_52 =
  [47; 12; 18; 43; 8; 10; 40; 36; 5; 17; 1; 17; 4; 8; 35; 35; 6; 0; 1; 18; 8;
   6; 6; 9; 11; 15; 5; 0; 17; 15; 5; 0; 15; 6; 14; 4; 3; 3; 10; 12; 8; 8; 9; 1;
   2; 0; 5; 1; 3; 2; 1; 0]

(* Le dernier nombre de notre permutation est donc à la position 47 dans
   [0..52[, c'est donc 47 (les positions commencent à 0).
   L'avant-dernier est à la position 12 dans
   [0..52[-{47}, c'est donc 12. L'avant-avant-dernier est à la position 18
   dans [0..52[-{12,47}, c'est donc 19. Et ainsi de suite.
   La permutation obtenue pour la graine 1 est donc bien ce que donne
   (shuffle_test 1), à savoir : *)

let permutation_graine_1 =
[ 13;32;33;35;30;46;7;29;9;48;38;36;51;41;26;20;23;43;27;
  42;4;21;37;39;2;15;34;28;25;17;16;18;31;3;0;10;50;49;
  14;6;24;1;22;5;40;44;11;8;45;19;12;47 ]
